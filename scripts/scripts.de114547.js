"use strict";angular.module("gsaApp",["ngResource","ngRoute","d3"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",title:"About"}).when("",{templateUrl:"views/main.html",controller:"MainCtrl",title:"About"}).when("/demo",{templateUrl:"views/demo.html",controller:"DemoController",title:"Demo"}).otherwise({templateUrl:"views/main.html",controller:"MainCtrl",title:"About"})}]),angular.module("gsaApp").controller("MainCtrl",["$scope","$rootScope",function(a,b){a.$on("$routeChangeSuccess",function(a,c){b.pageTitle=c.title})}]),angular.module("gsaApp").controller("DemoController",["$scope","$rootScope",function(a,b){a.$on("$routeChangeSuccess",function(a,c){b.pageTitle=c.title})}]).directive("d3Chart",["$http",function(a){function b(b,c){function d(a){var b=[],c={};a.forEach(function(a){a.count=+a.count;var b=a.time.substr(0,6);c[b]?c[b]=c[b]+a.count:c[b]=a.count});for(var d in c)b.push({time:d,count:c[d]});return b}function e(a){return new Date(a.substr(0,4)+"-"+a.substr(4,2)+"-01")}function f(b){var f,g={top:20,right:20,bottom:60,left:60},h=800-g.left-g.right,i=600-g.top-g.bottom,j=d3.time.scale().range([0,h]),k=d3.scale.linear().range([i,0]),l=d3.svg.axis().scale(j).orient("bottom").tickFormat(d3.time.format("%Y-%m")),m=d3.svg.axis().scale(k).orient("left"),n=d3.svg.line().x(function(a){return j(a.time)}).y(function(a){return k(a.count)});a.get(b).success(function(a){f=a.results,f=d(f),f.forEach(function(a){a.time=e(a.time)}),j.domain(d3.extent(f,function(a){return a.time})),k.domain(d3.extent(f,function(a){return a.count})),c.html("");var b=h+g.left+g.right,o=i+g.top+g.bottom,p=d3.select(c[0]).append("svg").attr("viewBox","0 0 "+b+" "+o).attr("class","svgChart").attr("aria-label","Adverse drug event reports since 2004 Graph").append("g").attr("transform","translate("+g.left+","+g.top+")");p.append("g").attr("class","y axis").attr("transform","translate(0,"+i+")").call(l).append("text").attr("x",h/2).attr("dy","3em").attr("font-weight","bold").style("text-anchor","middle").style("font-size","16px").text("Date"),p.append("g").attr("class","y axis").call(m).append("text").attr("transform","rotate(-90)").attr("x",-250).attr("y",-60).attr("dy",".71em").attr("font-weight","bold").style("font-size","16px").style("text-anchor","end").text("Count"),p.append("path").datum(f).attr("class","line").attr("d",n),p.selectAll(".xaxis text").attr("transform",function(){return"translate("+-2*this.getBBox().height+","+this.getBBox().height+")rotate(-45)"})})}b.$watch("filterUrl",function(a){f(a)}),f(b.filterUrl)}return{link:b}}]),angular.module("d3",[]).factory("d3Service",["$document","$q","$rootScope",function(a,b,c){function d(){c.$apply(function(){e.resolve(window.d3)})}var e=b.defer(),f=a[0].createElement("script");f.type="text/javascript",f.async=!0,f.src="bower_components/d3/d3.js",f.onreadystatechange=function(){"complete"===this.readyState&&d()},f.onload=d;var g=a[0].getElementsByTagName("body")[0];return g.appendChild(f),{d3:function(){return e.promise}}}]),angular.module("gsaApp").controller("HeaderController",["$scope","$location",function(a,b){a.isActive=function(a){return a===b.path()}}]);